import{r as g,j as e,u as p}from"./index-CvWWv6_a.js";import{B as o}from"./Button-CMOn0aGG.js";const j=({questions:r,onComplete:n})=>{const[i,u]=g.useState({}),[s,h]=g.useState(!1),[c,b]=g.useState(0),k=(t,d)=>{s||u(l=>({...l,[t]:d}))},x=()=>{let t=0;r.forEach(d=>{i[d.id]===d.correctAnswer&&t++}),b(t),h(!0),t===r.length&&n()};return e.jsxs("div",{className:"space-y-8 animate-fade-up visible",children:[r.map((t,d)=>{const l=s&&i[t.id]===t.correctAnswer;return s&&(i[t.id],t.correctAnswer),e.jsxs("div",{className:`p-6 rounded-2xl border ${s?l?"border-green-500/30 bg-green-100 dark:bg-green-900/10":"border-red-500/30 bg-red-100 dark:bg-red-900/10":"border-zinc-200 dark:border-white/10 bg-white dark:bg-zinc-900/50"}`,children:[e.jsxs("h3",{className:"text-lg font-bold text-zinc-900 dark:text-white mb-4",children:[e.jsxs("span",{className:"text-zinc-400 dark:text-zinc-500 mr-2",children:[d+1,"."]}),t.question]}),e.jsx("div",{className:"space-y-3",children:t.options.map((m,a)=>e.jsxs("div",{onClick:()=>k(t.id,a),className:`
                           p-4 rounded-xl cursor-pointer border transition-all duration-200 flex items-center justify-between
                           ${i[t.id]===a?"bg-blue-100 dark:bg-blue-600/20 border-blue-500 text-blue-900 dark:text-white":"bg-zinc-50 dark:bg-black border-zinc-200 dark:border-zinc-800 hover:border-zinc-400 dark:hover:border-zinc-600 text-zinc-700 dark:text-zinc-400"}
                           ${s&&a===t.correctAnswer?"!bg-green-100 dark:!bg-green-600/20 !border-green-500 !text-green-800 dark:!text-green-200":""}
                           ${s&&i[t.id]===a&&a!==t.correctAnswer?"!bg-red-100 dark:!bg-red-600/20 !border-red-500 !text-red-800 dark:!text-red-200":""}
                        `,children:[e.jsx("span",{children:m}),s&&a===t.correctAnswer&&e.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),s&&i[t.id]===a&&a!==t.correctAnswer&&e.jsx("svg",{className:"w-5 h-5 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]},a))}),s&&e.jsxs("div",{className:`mt-4 text-sm p-3 rounded-lg ${l?"text-green-800 dark:text-green-400 bg-green-200 dark:bg-green-900/20":"text-red-800 dark:text-red-400 bg-red-200 dark:bg-red-900/20"}`,children:[e.jsx("strong",{children:l?"Верно!":"Ошибка."})," ",t.explanation]})]},t.id)}),s?e.jsxs("div",{className:"text-center p-8 bg-zinc-100 dark:bg-zinc-900 rounded-2xl border border-zinc-200 dark:border-white/10",children:[e.jsxs("div",{className:"text-4xl font-bold text-zinc-900 dark:text-white mb-2",children:["Ваш результат: ",e.jsxs("span",{className:c===r.length?"text-green-500":"text-yellow-500",children:[c," / ",r.length]})]}),c===r.length?e.jsx("p",{className:"text-zinc-600 dark:text-zinc-400 mb-6",children:"Отличная работа! Модуль пройден."}):e.jsx("p",{className:"text-zinc-600 dark:text-zinc-400 mb-6",children:"Попробуйте еще раз, чтобы закрепить материал."}),c!==r.length&&e.jsx(o,{onClick:()=>{h(!1),u({}),b(0)},variant:"outline",children:"Попробовать снова"}),c===r.length&&e.jsx(o,{onClick:n,className:"ml-4",children:"Завершить урок"})]}):e.jsx("div",{className:"flex justify-end",children:e.jsx(o,{onClick:x,disabled:Object.keys(i).length!==r.length,size:"lg",children:"Отправить на проверку"})})]})},w=({course:r,lesson:n,onBack:i,onNavigate:u,onStartLesson:s})=>{const{completeLesson:h}=p(),[c,b]=g.useState(!1),x=(()=>{if(!r.fullCurriculum)return null;let d=!1;for(const l of r.fullCurriculum)for(const m of l.lessons){if(d)return m;m.id===n.id&&(d=!0)}return null})(),t=()=>{h(n.id),b(!0),window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})};return e.jsxs("div",{className:"min-h-screen bg-zinc-50 dark:bg-black pt-24 pb-20",children:[e.jsx("div",{className:"fixed top-20 left-0 right-0 h-16 bg-white/80 dark:bg-zinc-900/80 backdrop-blur border-b border-zinc-200 dark:border-white/5 flex items-center px-6 z-40 justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:i,className:"text-zinc-500 hover:text-black dark:text-zinc-400 dark:hover:text-white transition-colors flex items-center gap-2 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"К курсу"]}),e.jsx("div",{className:"h-4 w-px bg-zinc-300 dark:bg-zinc-700"}),e.jsx("span",{className:`text-${r.accentColor}-600 dark:text-${r.accentColor}-400 font-bold uppercase text-xs tracking-wider`,children:r.title}),e.jsx("span",{className:"text-zinc-400 dark:text-zinc-500 text-sm hidden md:inline",children:"/"}),e.jsx("span",{className:"text-zinc-900 dark:text-white text-sm font-medium truncate max-w-[200px] md:max-w-none",children:n.title})]})}),e.jsxs("div",{className:"max-w-4xl mx-auto px-6 mt-12",children:[e.jsxs("div",{className:"mb-12",children:[e.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-zinc-900 dark:text-white mb-6 leading-tight",children:n.title}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("span",{className:"px-3 py-1 bg-zinc-200 dark:bg-white/10 rounded-full text-xs text-zinc-700 dark:text-white border border-zinc-300 dark:border-white/10",children:n.type==="lecture"?"Теория":"Практика"}),e.jsx("span",{className:"px-3 py-1 bg-zinc-200 dark:bg-white/10 rounded-full text-xs text-zinc-700 dark:text-white border border-zinc-300 dark:border-white/10",children:n.duration})]})]}),e.jsxs("div",{className:`prose prose-lg dark:prose-invert max-w-none 
                         prose-headings:font-bold prose-headings:text-zinc-900 dark:prose-headings:text-white
                         prose-p:text-zinc-700 dark:prose-p:text-zinc-300 prose-p:leading-relaxed
                         prose-strong:text-zinc-900 dark:prose-strong:text-white
                         prose-ul:text-zinc-700 dark:prose-ul:text-zinc-300`,children:[n.data.type==="text"&&n.data.content&&e.jsx("div",{dangerouslySetInnerHTML:{__html:n.data.content},className:"bg-transparent"}),n.data.type==="quiz"&&n.data.questions&&e.jsx(j,{questions:n.data.questions,onComplete:t})]}),e.jsxs("div",{className:"mt-20 pt-10 border-t border-zinc-200 dark:border-white/10",children:[n.data.type!=="quiz"&&!c&&e.jsxs("div",{className:"flex justify-between items-center mb-10",children:[e.jsx("p",{className:"text-zinc-500 text-sm",children:"Изучите материал выше и нажмите кнопку для завершения."}),e.jsx(o,{onClick:t,size:"lg",children:"Завершить урок"})]}),c&&e.jsxs("div",{className:"bg-zinc-100 dark:bg-zinc-900/50 p-8 rounded-2xl border border-zinc-200 dark:border-white/10 animate-fade-up visible",children:[e.jsx("h3",{className:"text-2xl font-bold text-zinc-900 dark:text-white mb-4",children:"Урок пройден!"}),e.jsx("p",{className:"text-zinc-600 dark:text-zinc-400 mb-8",children:"Материал усвоен. Вы можете перейти к следующему заданию или вернуться в кабинет."}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[x?e.jsxs(o,{onClick:()=>s(r,x),size:"lg",className:"w-full sm:w-auto",children:["Следующий урок: ",x.title," →"]}):e.jsx("div",{className:"px-6 py-3 rounded-full bg-green-500/10 text-green-600 dark:text-green-400 border border-green-500/20 font-medium",children:"Курс завершен! Поздравляем!"}),e.jsx(o,{variant:"secondary",onClick:i,className:"w-full sm:w-auto",children:"В личный кабинет"})]})]})]})]})]})};export{w as LessonView};
